

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Debugging a Program Exit &mdash; BLE5-Stack User&#39;s Guide 1.00.01.04 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="BLE5-Stack User&#39;s Guide 1.00.01.04 documentation" href="../index.html"/>
        <link rel="up" title="Debugging" href="ble-index.html"/>
        <link rel="next" title="Migration Guides" href="../ble-stack-5.x-guide/migration.html"/>
        <link rel="prev" title="External Resources" href="gen-debugging.html"/> 
    <script language="JavaScript">
        var tiPageName;
        tiPageName = "sug debugging ble-debugging";

        if (location.protocol == "file:"){
            var ci_analytics_poc_load = true;
        }
    </script> 

    <script src="http://www.ti.com/assets/js/headerfooter/analytics.js" type="text/javascript" charset="utf-8">     


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../ble-stack-5.x-guide/index.html" class="icon icon-home"> BLE5-Stack User's Guide
          

          
          </a>

          
            
            
              <div class="version">
                1.00.01.04
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../cc2640/disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/get-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cc2640/platform.html">The CC2640R2F SDK Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x/index.html">Developing a Bluetooth Low Energy Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../u-stack/index.html">Micro BLE Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../oad/oad.html">Over the Air Download (OAD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../voice/voice.html">Creating a Voice Enabled Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sensor-controller/sensor-controller.html">Sensor Controller</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="ble-index.html">Debugging</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html">External Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#debug-interfaces">Debug Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#configuring-debugger-in-ccs">Configuring Debugger in CCS</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#configuring-debugger-in-iar">Configuring Debugger in IAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#breakpoints">Breakpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#considerations-on-breakpoints">Considerations on Breakpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#watching-variables-and-registers">Watching Variables and Registers</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#memory-watchpoints">Memory Watchpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#ti-rtos-object-viewer">TI-RTOS Object Viewer</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#using-the-memory-browser">Using the Memory Browser</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#debugging-common-heap-issues">Debugging Common Heap Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#optimizations">Optimizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#deciphering-cpu-exceptions">Deciphering CPU Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#debugging-memory-problems">Debugging Memory Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="gen-debugging.html#check-system-flash-and-ram-usage-with-map-file">Check System Flash and RAM Usage With Map File</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Debugging a Program Exit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hal-assert-handling">HAL Assert Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#catching-stack-asserts-in-the-application">Catching Stack Asserts in the Application</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/migration.html">Migration Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/api-reference.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ble-stack-5.x-guide/reference.html">Terms and Definitions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../ble-stack-5.x-guide/index.html">BLE5-Stack User's Guide</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../ble-stack-5.x-guide/index.html">Docs</a> &raquo;</li>
        
          <li><a href="ble-index.html">Debugging</a> &raquo;</li>
        
      <li>Debugging a Program Exit</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="debugging-a-program-exit">
<h1>Debugging a Program Exit<a class="headerlink" href="#debugging-a-program-exit" title="Permalink to this headline">¶</a></h1>
<p>The program must never exit the <code class="docutils literal"><span class="pre">main()</span></code> function. The usual cause for this is
that some software module has called <code class="docutils literal"><span class="pre">abort()</span></code>.</p>
<p>Both IAR and CCS will halt execution when this happens, and the disassembly and
call stack will show some type of <cite>__exit</cite> symbol.</p>
<p>The BLE Stack will call <code class="docutils literal"><span class="pre">ICall_abort()</span></code> when one of the below happens:</p>
<ul class="simple">
<li>Calling an ICall function from a stack callback</li>
<li>Misconfiguring of additional ICall tasks or entities</li>
<li>Incorrect ICall task registering</li>
</ul>
<p>Should the call stack not give enough information to deduce the cause of the
abort, a breakpoint can be set in the <code class="docutils literal"><span class="pre">ICall_abort</span></code> function to trace from
where this error is coming.</p>
</div>
<div class="section" id="hal-assert-handling">
<h1>HAL Assert Handling<a class="headerlink" href="#hal-assert-handling" title="Permalink to this headline">¶</a></h1>
<p>Asserts can be useful when debugging, to trap undesirable states in
the code. The BLE Stack projects are by default set up to have the global
preprocessor symbol <code class="docutils literal"><span class="pre">EXT_HAL_ASSERT</span></code> enabled, which will try to call an assert
handler that the user application can define.</p>
<div class="section" id="catching-stack-asserts-in-the-application">
<h2>Catching Stack Asserts in the Application<a class="headerlink" href="#catching-stack-asserts-in-the-application" title="Permalink to this headline">¶</a></h2>
<p>The application has an assert callback to catch asserts in the stack
project. The assert callback is registered in main() function of
each project:</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cm">/* Register Application callback to trap asserts raised in the Stack */</span>
<span class="n">RegisterAssertCback</span><span class="p">(</span><span class="n">AssertHandler</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">main.c</span></code> file also contains an example <code class="docutils literal"><span class="pre">AssertHandler</span></code> function.</p>
<p>Some generic assert causes that can be returned in the callback
include <code class="docutils literal"><span class="pre">HAL_ASSERT_CAUSE_TRUE</span></code>,
<code class="docutils literal"><span class="pre">HAL_ASSERT_CAUSE_OUT_OF_MEMORY</span></code>, and
<code class="docutils literal"><span class="pre">HAL_ASSERT_CAUSE_ICALL_ABORT</span></code>.</p>
<p>When using a split-image build configuration, it may be possible to get a
<code class="docutils literal"><span class="pre">HAL_ASSERT_CAUSE_INTERNAL_ERROR</span></code> assertion. This typically indicates that
the ICall <code class="docutils literal"><span class="pre">bleAPITable</span></code> dispatch table is missing some functions so it calls
a generic <code class="docutils literal"><span class="pre">icall_liteErrorFunction</span></code> error handler. Typically, a fix for this
is error is to enable a missing predefined compiler option to get correct APIs
into <code class="docutils literal"><span class="pre">bleAPITable</span></code>.</p>
<p>The user can decide how to handle
these asserts in the callback. By default, it goes into spinlock for
most of the asserts.</p>
<p>The assert can also define a subcause that gives a more specific
reason for the assert. An example of a subcause is
<code class="docutils literal"><span class="pre">HAL_ASSERT_OUT_OF_HEAP</span></code>, which describes the type of memory
causing the assert for <code class="docutils literal"><span class="pre">HAL_ASSERT_CAUSE_OUT_OF_MEMORY</span></code>.</p>
<p>If no application callback is registered, the default assert
callback is called and returns without further action unless
<code class="docutils literal"><span class="pre">HAL_ASSERT_SPIN</span></code> is defined in the application project, which traps
the application in an infinite while loop. In addition, one of the
following can also be defined in the stack project if it is not
caught in the application callback:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">HAL_ASSERT_RESET</span></code>: Resets the device</li>
<li><code class="docutils literal"><span class="pre">HAL_ASSERT_LIGHTS</span></code>: Turn on the hazard lights (to be configured by
user)</li>
<li><code class="docutils literal"><span class="pre">HAL_ASSERT_SPIN</span></code>: Spinlock in a while loop indefinitely</li>
</ul>
<p>Enable these by ensuring that one of the above corresponding symbols
are defined in the preprocessor symbols.</p>
<p>See hal_assert.h and hal_assert.c in the stack project for
implementation details.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ble-stack-5.x-guide/migration.html" class="btn btn-neutral float-right" title="Migration Guides" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gen-debugging.html" class="btn btn-neutral" title="External Resources" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Texas Instruments.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.00.01.04',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>